language: node_js

# Disable email notifications
notifications:
  email: false

env:
  global:
    - CXX=g++-4.8

sudo: false
dist: trusty

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - g++-4.8

cache:
  apt: true
  yarn: true
  directories:
    - node_modules

matrix:
  # Allow coding conventions tests to fail
  allow_failures:
    - env: TEST_SUITE=test:coding-conventions
  include:
    # Nodejs 6 - Webdriver.io
    - node_js: 6
      env: TEST_SUITE=test:functional
      addons:
        apt:
          packages:
            - graphicsmagick
        artifacts:
          paths:
            - $TRAVIS_BUILD_DIR/test/screenshots/diff/
            - $TRAVIS_BUILD_DIR/test/errorShots/
        sauce_connect: true

    # Nodejs 6 - Lint
    - node_js: 6
      env: TEST_SUITE=test:coding-conventions

before_script:
  - if [ "${TEST_SUITE}" = "test:functional" ]; then npm run dist; fi

script:
  - npm run $TEST_SUITE
