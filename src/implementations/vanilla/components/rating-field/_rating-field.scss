/* stylelint-disable no-descending-specificity */

/**
 * Rating field
 * @define rating-field
 */

@use 'sass:map';
@use '@ecl/vanilla-layout-grid/mixins/breakpoints';

// Exposed variables
$theme: null !default;
$rating-field: null !default;

.ecl-rating-field {
  display: inline-flex;
  flex-direction: row-reverse;

  .ecl-rating-field__input {
    &:checked,
    &:active {
      ~ .ecl-rating-field__label {
        .ecl-rating-field__icon-outline {
          display: none;
        }

        .ecl-rating-field__icon-filled {
          display: inline-block;
        }

        &:hover .ecl-rating-field__icon-filled {
          fill: map.get($rating-field, 'checked-hover-color');
        }
      }
    }
  }

  &:not(.ecl-rating-field--disabled) {
    .ecl-rating-field__input
      + .ecl-rating-field__label:hover
      .ecl-rating-field__icon-outline {
      fill: map.get($rating-field, 'hover-stroke-color');
    }

    .ecl-rating-field__input:focus {
      + .ecl-rating-field__label {
        @if map-has-key($rating-field, 'focus-circle') {
          outline: none;

          &::before {
            @each $property, $value in map.get($rating-field, 'focus-circle') {
              #{$property}: $value;
            }
          }
        } @else {
          outline: 2px solid var(--ecl-color-primary-100);
        }
      }

      &:checked + .ecl-rating-field__label .ecl-rating-field__icon-filled {
        stroke: map.get($rating-field, 'checked-focus-stroke');
      }
    }
  }

  &--disabled .ecl-rating-field__input + .ecl-rating-field__label {
    cursor: not-allowed;
    opacity: 0.5;
  }
}

.ecl-rating-field__input {
  border: 0;
  clip: rect(0, 0, 0, 0);
  clip-path: inset(50%);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  white-space: nowrap;
  width: 1px;
}

.ecl-rating-field__label {
  cursor: pointer;
  margin-inline-end: map.get($theme, 'spacing', 'xs');
  position: relative;
}

.ecl-rating-field__icon-filled {
  display: none;
  fill: map.get($rating-field, 'checked-color');
  position: relative;
}

.ecl-rating-field__icon-outline {
  fill: map.get($rating-field, 'stroke-color');
  position: relative;
}

@include breakpoints.up('m') {
  .ecl-rating-field {
    .ecl-rating-field__input + .ecl-rating-field__label {
      margin-inline-end: map.get($theme, 'spacing', '2xs');
    }

    .ecl-rating-field__icon-filled,
    .ecl-rating-field__icon-outline {
      width: 1.5rem;
      height: 1.5rem;
    }

    &:not(.ecl-rating-field--disabled)
      .ecl-rating-field__input:focus
      + .ecl-rating-field__label {
      @if map-has-key($rating-field, 'focus-circle') {
        &::before {
          height: 1.875rem;
          width: 1.875rem;
        }
      }
    }
  }
}
