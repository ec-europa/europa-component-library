/* stylelint-disable no-descending-specificity */

/**
 * Rating field
 * @define rating-field
 */

@use 'sass:map';
@use '@ecl/vanilla-layout-grid/mixins/breakpoints';

// Exposed variables
$theme: null !default;
$rating-field: null !default;

.ecl-rating-field {
  display: inline-flex;
  flex-direction: row-reverse;

  .ecl-rating-field__input:checked
    ~ .ecl-rating-field__label
    .ecl-rating-field__icon-filled,
  &:not(.ecl-rating-field--disabled)
    > .ecl-rating-field__label:hover
    .ecl-rating-field__icon-filled,
  &:not(.ecl-rating-field--disabled)
    > .ecl-rating-field__label:hover
    ~ .ecl-rating-field__label
    .ecl-rating-field__icon-filled {
    display: inline-block;
  }

  .ecl-rating-field__input:checked
    ~ .ecl-rating-field__label
    .ecl-rating-field__icon-outline,
  &:not(.ecl-rating-field--disabled)
    > .ecl-rating-field__label:hover
    .ecl-rating-field__icon-outline,
  &:not(.ecl-rating-field--disabled)
    > .ecl-rating-field__label:hover
    ~ .ecl-rating-field__label
    .ecl-rating-field__icon-outline {
    display: none;
  }
}

.ecl-rating-field__input {
  border: 0;
  clip: rect(0, 0, 0, 0);
  clip-path: inset(50%);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  white-space: nowrap;
  width: 1px;
}

.ecl-rating-field__label {
  cursor: pointer;
  margin-inline-end: map.get($theme, 'spacing', 'xs');
  position: relative;

  .ecl-rating-field--disabled & {
    cursor: default;
  }
}

.ecl-rating-field__icon-filled {
  display: none;
  fill: map.get($theme, 'color', 'yellow-100');
}

.ecl-rating-field__icon-outline {
  fill: var(--ecl-color-dark-80);
}

.ecl-rating-field:not(.ecl-rating-field--disabled)
  .ecl-rating-field__input:focus,
.ecl-rating-field:not(.ecl-rating-field--disabled)
  .ecl-rating-field__input:active {
  + .ecl-rating-field__label {
    @if map-has-key($rating-field, 'focus-circle') {
      outline: none;

      &::before {
        @each $property, $value in map.get($rating-field, 'focus-circle') {
          #{$property}: $value;
        }
      }
    } @else {
      outline: 2px solid var(--ecl-color-primary-100);
    }
  }

  &:checked + .ecl-rating-field__label .ecl-rating-field__icon-filled {
    stroke: var(--ecl-color-dark-100);
    stroke-width: 2px;
    vector-effect: non-scaling-size;
  }
}
