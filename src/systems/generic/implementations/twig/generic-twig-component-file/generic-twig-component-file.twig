{#
  Parameters:
    - "variant" (string): can be 'translations', 'links', 'images', 'videos' or empty
    - "extra_classes" (string) (default: '')
    - "extra_attributes" (array) (default: []): format: [
        {
          "name" (string) (default: ''),
          "value" (string) (default: '')
        },
        ...
      ]
    - "system" (string) (default: "generic")

  Default parameters:
    - "title" (string): title of the file (default: empty)
    - "language" (string): language of the file (default: empty)
    - "meta" (string): additional information concerning the file: size, type, number of page (default: empty)
    - "button_label" (string): label of the download button (default: "Download")
    - "icon" (object) (default: {}): object of type ecl-icon; type of file
    - "icon_download" (object) (default: {}): object of type ecl-icon; for download button

  Translations variant parameters:
    - "title" (string): title of the file (default: empty)
    - "language" (string): language of the file (default: empty)
    - "meta" (string): additional information concerning the file: size, type, number of page (default: empty)
    - "button_label" (string): label of the download button (default: "Download")
    - "icon" (object) (default: {}): object of type ecl-icon; type of file
    - "icon_download" (object) (default: {}): object of type ecl-icon; for download button
    - "icon_expand" (object) (default: {}): object of type ecl-icon; to expand list of translations
    - "translations" (array) [{
      - "title" (string): title of the translated file (default: empty)
      - "meta" (string): additional information concerning the translated file: size, type, number of page (default: empty)
    }]
    - "translations_label" (string): global label for translations area. Shoud display number of translations (default: "Available languages: 0")
    - "translations_tooltip" (string): tooltip when hovering global label (default: "Click to see translations")

  Links variant parameters:
    - "links" (array): [{
      - "title" (string): title of the link (default: empty)
      - "icon" (object) (default: {}): object of type ecl-icon; type of file
      - "icon_download" (object) (default: {}): object of type ecl-icon; for download button
      - "href" (string): target of the link (default: empty)
      - "is_external" (boolean): is the link an external link or not (default: false)
      - "type" (string): (optional) extension of the file (default: empty)
    }]

  Images variant parameters:
    - "src" (string): source of the image (default: empty)
    - "alt" (string): alternative text for the image (default: empty)
    - "caption" (string): description of the image (default: empty)

  Videos variant parameters:
    - "src" (string): source of the video (default: empty)
    - "caption" (string): description of the video (default: empty)
    - "is_iframe" (boolean): video is displayed in an iframe or not (default: false)
    - "ratio" (string): ratio of the video. Should be one of ecl-ratio. Format: '16-9' (default: empty)
#}

{# Internal properties #}

{% set _button_label = button_label|default('Download') %}
{% set _translations_label = translations_label|default('Available languages: 0') %}
{% set _translations_tooltip = translations_tooltip|default('Click to see translations') %}
{% set _icon = icon|default({}) %}
{% set _icon_download = icon_download|default({}) %}
{% set _icon_expand = icon_expand|default({}) %}
{% set _css_class = 'ecl-file' %}
{% set _extra_attributes = '' %}
{% set _system = system|default('generic') %}

{# Internal logic - Process properties #}

{% if variant is not empty %}
  {% set _css_class = _css_class ~ ' ecl-file--' ~ variant %}
{% endif %}

{% if extra_classes is defined and extra_classes is not empty %}
  {% set _css_class = _css_class ~ ' ' ~ extra_classes %}
{% endif %}

{% if extra_attributes is defined and extra_attributes is not empty and extra_attributes is iterable %}
  {% for attr in extra_attributes %}
    {% set _extra_attributes = _extra_attributes ~ ' ' ~ attr.name ~ '="' ~ attr.value ~ '"' %}
  {% endfor %}
{% endif %}

{# Print the result #}

{% if variant is defined %}
  {% if variant == "translation" %}
    <section class="{{ _css_class }}"{{ _extra_attributes|raw }}>
      <div class="ecl-file__body">
        <div class="ecl-row">
          <div class=" ecl-col ecl-col-md-8">
            {% include '@ecl/' ~ _system ~ '-twig-style-icon' with {
              'extra_classes': 'ecl-file__icon'
            }|merge(_icon|default({})) only %}
            <div class="ecl-file__metadata">
              <div class="ecl-file__title">{{ title }}</div>
              <div class="ecl-file__info">
                <span class="ecl-file__language">{{ language }}</span>
                <span class="ecl-file__properties">({{ meta }})</span>
              </div>
            </div>
          </div>
          <div class="ecl-col-12 ecl-col-md-4">
            {% include '@ecl/' ~ _system ~ '-twig-component-button' with {
              'type_attribute': 'button',
              'label': _button_label ~ '<span class="ecl-u-sr-only">(' ~ meta ~ ')</span>',
              'is_block': true,
              'icon': _icon_download,
              'extra_classes': 'ecl-file__download'
            } only %}
          </div>
        </div>
      </div>
      <div class="ecl-file__translations">
        {% include '@ecl/' ~ _system ~ '-twig-component-button' with {
          'label': translations_label,
          'modifier': 'secondary',
          'type_attribute': 'button',
          'icon': _icon_expand,
          'extra_classes': 'ecl-file__translations-toggle ecl-expandable__button',
          'extra_attributes': [
            { 'name': 'aria-controls', 'value': 'translations-expand' },
            { 'name': 'aria-expanded', 'value': 'true' },
            { 'name': 'id', 'value': 'translations-expand-button' },
            { 'name': 'title', 'value': translations_tooltip }
          ]
        } only %}
        <div aria-hidden="false" aria-labelledby="translations-expand-button" class="ecl-u-aria" id="translations-expand">
          <ul class="ecl-file__translations-list">
            {% if translations is defined %}
              {% for translation in translations %}
                <li class="ecl-file__translations-item">
                  <div class="ecl-file__translations-metadata">
                    <span class="ecl-file__translations-title">{{ translation.title }}</span>
                    <div class="ecl-file__translations-info">({{ translation.meta }})</div>
                  </div>
                  {% include '@ecl/' ~ _system ~ '-twig-component-button' with {
                    'label': _button_label ~ '<span class="ecl-u-sr-only">(' ~ translation.meta ~ ')</span>',
                    'modifier': 'secondary',
                    'type_attribute': 'button',
                    'icon': _icon_download,
                    'extra_classes': 'ecl-file__translations-download'
                  } only %}
                </li>
              {% endfor %}
            {% endif %}
          </ul>
        </div>
      </div>
    </section>
  {% elseif variant == "link" %}
    <section class="{{ _css_class }}"{{ _extra_attributes|raw }}>
      {% if links is defined %}
        {% for link in links %}
          <div class="ecl-file__link-container">
            <a
              href="{{ link.href }}"
              class="ecl-link ecl-file__link {% if link.is_external is defined and link.is_external %}ecl-link--external{% endif %}">
              {% include '@ecl/' ~ _system ~ '-twig-style-icon' with {
                'extra_classes': 'ecl-file__icon'
              }|merge(link.icon|default({})) only %}
              <span class="ecl-file__title">{{ link.title }}</span>
              {% if link.type is defined %}
              <span class="ecl-file__type">{{ link.type }}</span>
              {% endif %}
            </a>
          </div>
        {% endfor %}
      {% endif %}
    </section>
  {% elseif variant == "image" %}
    <section class="{{ _css_class }}"{{ _extra_attributes|raw }}>
      <img class="ecl-file__image" src="{{ src }}" alt="{{ alt }}">
      <div class="ecl-file__caption">{{ caption }}</div>
    </section>
  {% elseif variant == "video" %}
    <section class="{{ _css_class }}"{{ _extra_attributes|raw }}>
      {% if src is defined %}
        {% if is_iframe is defined and is_iframe %}
      <div {% if ratio is defined %} class="ecl-u-ratio-{{ ratio }}" {% endif %}>
        <iframe class="ecl-file__video" src="{{ src }}" allowfullscreen="allowfullscreen" scrolling="no"></iframe>
      </div>
        {% else %}
      <div {% if ratio is defined %} class="ecl-u-ratio-{{ ratio }}" {% endif %}>
        <video class="ecl-file__video" src="{{ src }}" type="video/mp4" controls="controls"></video>
      </div>
        {% endif %}
      {% endif %}
      <div class="ecl-file__caption">{{ caption }}</div>
    </section>
  {% endif %}
{% else %}
  <section class="{{ _css_class }}"{{ _extra_attributes|raw }}>
    <div class="ecl-file__body">
      <div class="ecl-row">
        <div class=" ecl-col ecl-col-md-8">
          {% include '@ecl/' ~ _system ~ '-twig-style-icon' with {
            'extra_classes': 'ecl-file__icon'
          }|merge(_icon|default({})) only %}
          <div class="ecl-file__metadata">
            <div class="ecl-file__title">{{ title }}</div>
            <div class="ecl-file__info">
              <span class="ecl-file__language">{{ language }}</span>
              <span class="ecl-file__properties">({{ meta }})</span>
            </div>
          </div>
        </div>
        <div class="ecl-col-12 ecl-col-md-4">
          {% include '@ecl/' ~ _system ~ '-twig-component-button' with {
            'label': _button_label ~ '<span class="ecl-u-sr-only">(' ~ meta ~ ')</span>',
            'is_block': true,
            'icon': _icon_download,
            'extra_classes': 'ecl-file__download',
            'extra_attributes': [{ 'name': 'type', 'value': 'button' }]
          } only %}
        </div>
      </div>
    </div>
  </section>
{% endif %}
