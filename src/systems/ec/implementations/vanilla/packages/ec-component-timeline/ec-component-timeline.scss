/**
 * Timeline
 * @define timeline
 */

// Import base
@import '@ecl/ec-base/ec-base';

@mixin ecl-timeline(
  $border-width: 0.25rem,
  $border-color: $ecl-color-yellow-100,
  $bullet-fill-color: $ecl-color-white-100,
  $bullet-border-color: $ecl-color-grey-100,
  $bullet-border-width: 0.25rem,
  $label-color: $ecl-color-grey-100,
  $content-color: $ecl-color-grey-100
) {
  .ecl-timeline {
    border-left: $border-width solid $border-color;
    list-style: none;
    // Leave space for the bullets
    margin: 0 0 0 (($ecl-spacing-s / 2) + $bullet-border-width);
    padding: $ecl-spacing-m 0;
  }

  .ecl-timeline__item {
    padding-left: (
      $ecl-spacing-m + ($ecl-spacing-s / 2) + $bullet-border-width -
        $border-width
    );
    position: relative;

    &::before {
      background-color: $bullet-fill-color;
      border: $bullet-border-width solid $bullet-border-color;
      border-radius: 50%;
      content: '';
      height: $ecl-spacing-s;
      left: -($ecl-spacing-s);
      position: absolute;
      top: 0;
      width: $ecl-spacing-s;
    }
  }

  .ecl-timeline__item + .ecl-timeline__item {
    margin-top: $ecl-spacing-m;
  }

  .ecl-timeline__label {
    color: $label-color;
    font: $ecl-font-m;
    font-weight: bold;
  }

  .ecl-timeline__content {
    color: $content-color;
    font: $ecl-font-prolonged-m;
    margin-top: $ecl-spacing-m;
  }

  .ecl-timeline__item--toggle {
    margin-top: $ecl-spacing-xl - $ecl-spacing-m;

    &::before {
      display: none;
    }

    .no-js & {
      display: none;
    }
  }

  /*
   * Manage collapse
   */
  .ecl-timeline__item--collapsed {
    display: none;

    .no-js & {
      display: block;
    }
  }

  .ecl-timeline[aria-expanded='true'] {
    .ecl-timeline__item--collapsed {
      display: block;
    }

    .ecl-timeline__item--toggle {
      display: none;
    }
  }
}

/*
* @define timeline2; weak
*/
@mixin ecl-timeline2(
  $left-spacing: 10rem,
  $border-width: 0.25rem,
  $border-color: $ecl-color-grey-100,
  $bullet-fill-color: $ecl-color-white-100,
  $bullet-size: $ecl-spacing-s,
  $bullet-border-color: $ecl-color-yellow-100,
  $bullet-border-width: 0.25rem,
  $toggle-bullet-border-color: $ecl-color-grey-25,
  $toggle-bullet-border-width: 0.125rem,
  $label-color: $ecl-color-grey-100,
  $content-color: $ecl-color-grey-100
) {
  // Timeline structure
  .ecl-timeline2 {
    list-style: none;
    margin: 0 $ecl-spacing-l 0
      ($ecl-spacing-l + ($bullet-size / 2) + $bullet-border-width);
    padding-left: 0;
  }

  .ecl-timeline2__item {
    padding-bottom: $ecl-spacing-l;
    padding-left: $ecl-spacing-m + ($bullet-size / 2) + $bullet-border-width;
    padding-top: $ecl-spacing-xs;
    position: relative;

    // Border
    &::before {
      border-left: $border-width solid $border-color;
      content: '';
      height: 100%;
      left: -($border-width / 2);
      position: absolute;
      top: 0;
      width: 0;
    }

    // Bullet
    &::after {
      background-color: $bullet-fill-color;
      border: $bullet-border-width solid $bullet-border-color;
      border-radius: 50%;
      content: '';
      height: $bullet-size;
      left: -(($bullet-size / 2) + $bullet-border-width);
      position: absolute;
      top: $ecl-spacing-xs;
      width: $bullet-size;
    }
  }

  .ecl-timeline2__item:hover::after {
    background-color: $bullet-border-color;
  }

  /* stylelint-disable-next-line order/order */
  @include ecl-media-breakpoint-up(sm) {
    .ecl-timeline2 {
      margin-left: $ecl-spacing-xs + $left-spacing + $ecl-spacing-m;
      margin-right: $ecl-spacing-xs;
    }
  }

  // Toggle button
  .ecl-timeline2__item--toggle {
    &::before {
      border-left-style: dashed;
    }

    &::after {
      border: $toggle-bullet-border-width solid $toggle-bullet-border-color;
      height: $bullet-size +
        ($bullet-border-width - $toggle-bullet-border-width);
      top: $ecl-spacing-xs + $ecl-spacing-s;
      width: $bullet-size + ($bullet-border-width - $toggle-bullet-border-width);
    }

    .no-js & {
      display: none;
    }
  }

  .ecl-timeline2[data-ecl-timeline-expanded] .ecl-timeline2__item--toggle {
    padding-bottom: $ecl-spacing-xs;
    padding-top: $ecl-spacing-l;

    &::after {
      top: $ecl-spacing-l + $ecl-spacing-s;
    }
  }

  .ecl-timeline2__toggle[aria-expanded='true'] .ecl-icon {
    transform: rotate(0deg);
  }

  // Border adjustment
  .ecl-timeline2__item:first-child::before {
    height: calc(100% - #{$ecl-spacing-xs});
    top: $ecl-spacing-xs;
  }

  .ecl-timeline2__item:last-child::before {
    height: $ecl-spacing-xs;
  }

  // Timeline data
  .ecl-timeline2__label {
    color: $label-color;
    font: $ecl-font-m;
  }

  .ecl-timeline2__content {
    color: $content-color;
    font: $ecl-font-m;
    margin-top: $ecl-spacing-s;
  }

  /* stylelint-disable-next-line order/order */
  @include ecl-media-breakpoint-up(sm) {
    .ecl-timeline2__label {
      font-weight: $ecl-font-weight-bold;
      left: -($left-spacing + $ecl-spacing-m + ($bullet-size / 2) +
            $bullet-border-width);
      position: absolute;
      text-align: right;
      top: $ecl-spacing-xs;
      width: $left-spacing;
    }

    .ecl-timeline2__content {
      margin-top: 0;
    }
  }

  // Collapsible items
  .ecl-timeline2__item--collapsed {
    display: none;

    .no-js & {
      display: block;
    }
  }

  .ecl-timeline2[data-ecl-timeline-expanded] .ecl-timeline2__item--collapsed {
    display: block;
  }
}

// Use mixin
@include exports('ec-component-timeline') {
  @include ecl-timeline();
  @include ecl-timeline2();
}
